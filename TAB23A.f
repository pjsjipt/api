     
      SUBROUTINE TAB23A(SG,DEGF, IHYDRO, SG60, IFLAG)
      

      double precision SG, DEGF, SG60
      integer IHYDRO, IFLAG

      DATA IBASE /600/
      DATA LIM1,LIM2/1074982, 610627/
      DATA IBP1, IBP2 / 7795, 8250 /
      DATA ITMP1, ITEMP2, ITEMP3 / 2000, 2500, 3000 /
      DATA IEP1, IEP2, IEP3 / 1500, 2000, 2500 /
      DATA IESG / 7585 /
      DATA K0, K1 / 3410957, 0 /
      DATA IH2O / 999012 /
      
      
      NOUT = 6
      ISG=((SG*100000)+25)/50
      ISG=ISG*5
      SG=FLOAT(ISG)/10000
      
      IF (DEGF) 900, 10, 10
 10   IT=((DEGF*100)+5)/10
      DEGF=FLOAT(IT)/10.0
      
      IF (ISG-6110) 900, 40, 40
 40   IF (ISG-10760) 50, 50, 900
 50   IF (ISG-IBP1) 60, 60, 70
 60   IF (IT-ITMP1)100, 100, 900
 70   IF(ISG-IBP2) 80, 80, 90
 80   IF (IT-ITMP2)100, 100, 900
 90   IF (IT-ITMP3)100, 100, 900
 100  CONTINUE
      
      IFLAG=0
      IDT=IT-IBASE
      CALL MPY23A(ISG,IH2O,IRHOT,10)
      IRHOT=(IRHOT + 500)/1000
      
      IF(IHYDRO) 101, 101, 140
 101  IRD=50
      IF(IDT)105, 110, 110
 105  IRD=-50
 110  IH1=(127800*IDT+IRD)/100
      IH2=(62*IDT*IDT+500)/1000
      IHYC=1000000000-IH1-IH2
      IRHO=IRHOT*10
      CALL MPY23A(IRHO, IHYC, IRHOT,10000)
      IRHOT=(IRHOT+50)/100
 140  JRHOT=IRHOT*10000
      IRHO60=IRHOT
      KRHO=0
      NP=0
 300  NP=NP+1
      CALL ALF23A(IRHO60,K0,K1,IALF)
      CALL VCF23A(IALF,IDT,IVCF)
      IVCF=(IVCF+50)/100
      CALL DIV23A(JRHOT,IVCF,IRHO60,1000)
      IF(IABS(IRHO60-KRHO)-50)500, 320, 320
 320  KRHO=IRHO60
      IRHO60=(IRHO60+5)/10
      IF(NP-20) 300, 400, 400
 400  IFLAG=-1
      SG60=-9.9999
      WRITE(NOUT,6001)DEGF, SG
 6001 FORMAT(5H1 AT ,F6.1,15H DEGREES F AND ,F8.4,84H RELATIVE DENSITY,A
     & ACORRESPONDING RELATIVE DENSITY 6060 F  COULD NOT BE DETERMINED.)
      
      RETURN
      
 500  IF (IRHO60-LIM1)510,510,900
 510  IF(IRHO60-LIM2)900,520,520
 520  JRHOT=IRHO60*1000
      CALL DIV23A(JRHOT,IH2O,ISG60,1000)
      ISG60=(ISG60+50)/100
      SG60=FLOAT(ISG60)/10000
      IF (ISG-IESG) 760,760,770
 760  IFLAG=1
      RETURN
      
 770  IF(ISG-IBP1)780,780,790
 780  IF(IT-IEP1)820,820,760
 790  IF(ISG-IBP2)800,800,810
      
 800  IF(IT-IEP2)820,820,760
 810  IF(IT-IEP3)820,820,760
 820  CONTINUE
      RETURN
      
 900  IFLAG = -1
      SG60=-9.9999
      
      RETURN
      END
      
      
      SUBROUTINE DIV23A(INUM,IDENOM,IRES,ISCALE)
      
      
      IRES1=INUM/IDENOM
      IRES2=(INUM-IRES1*IDENOM)*ISCALE/IDENOM
      
      IRES=IRES1*ISCALE+IRES2
      RETURN
      END
      
      SUBROUTINE ALF23A(IRHO,K0,K1,IALF)
      INUM=K1*10000
      CALL DIV23A(INUM,IRHO,IALF1,10000)
      
      INUM=K0*100
      CALL DIV23A(INUM,IRHO,IALFS,10000)
      CALL DIV23A(IALFS,IRHO,IALF2,10000)
      IALF=(IALF1+IALF2+500)/1000
      RETURN
      END
      
      SUBROUTINE VCF23A(IALF,IDT,IVCF)
      
      ITERM1=IALF*IDT
      ITERM2=ITERM1/5*40
      
      CALL MPY23A(ITERM1,ITERM2,ITERM3,1000)
      ITERM3=(ITERM3+500)/1000
      IX=-ITERM1-ITERM3
      
      ISUM1=100000000+IX
      CALL MPY23A(IX,IX,ISUM2,1000)
      ISUM2=((ISUM2+50)/100)/2
      CALL MPY23A(IX,ISUM2,ISUM3,1000)
      ISUM3=((ISUM3+50)/100)/3
      CALL MPY23A(IX,ISUM3,ISUM4,1000)
      ISUM4=((ISUM4+50)/100)/4
      CALL MPY23A(IX,ISUM4,ISUM5,1000)
      ISUM5=((ISUM5+50)/100)/5
      CALL MPY23A(IX,ISUM5,ISUM6,1000)
      ISUM6=((ISUM6+50)/100)/6
      
      IVCF=ISUM1+ISUM2+ISUM3+ISUM4+ISUM5+ISUM6
      RETURN
      END
      
      
      SUBROUTINE MPY23A(IX,IY,IZ,ISCALE)
      
      
      IU1=IX/ISCALE
      K1=ISCALE*IU1
      IV1=IX-K1
      IU2=IY/ISCALE
      K2=ISCALE*IU2
      IV2=IY-K2
      K3=IU1*IV2+IU2*IV1+IV1*IV2/ISCALE
      IZ=(K3+ISCALE/2)/ISCALE + IU1*IU2
      RETURN
      END    
      
      
